title: Application users management
roles: [admin]

methods:
  read:
    title: Read users
    params:
      - name: options
        schema:
          read:
            fields:
              id: { type: string, operator: "=", sortable: true }
              search: { type: string, operator: like }
              roles: { type: string, operator: in }
              name: { sortable: true }
              created: { sortable: true }
              last_activity: { sortable: true }
              enabled: { sortable: true }
            order_by: [["name", "desc"]]
            limit: { maxLimit: 100 }

  create:
    title: Create user
    params:
      - name: fields
        required: true
        schema:
          type: object
          properties:
            username: { type: string }
            password: { type: string }
            enabled: { type: boolean }
            roles:
              type: object
              additionalProperties: { type: boolean }
            email: { type: string }
            telegram_username: { type: string }
          required:
            - username

  delete:
    title: Remove user
    params:
      - name: user_id
        required: true
        schema:
          type: string

  set-enabled:
    title: Set user enabled
    params:
      - name: user_id
        description: User id or name.
        required: true
        schema:
          type: string
      - name: enabled
        required: true
        schema:
          type: boolean

  set-password:
    title: Set user password
    params:
      - name: user_id
        description: User id or name.
        required: true
        schema:
          type: string
      - name: pasword
        schema:
          type: string

  get-roles:
    title: Get user roles
    params:
      - name: user_id
        required: true
        schema:
          type: string

  set-roles:
    title: Set user roles
    params:
      - name: user_id
        required: true
        schema:
          type: string
      - name: roles
        required: true
        schema:
          type: object
          additionalProperties: { type: boolean }

  update-roles:
    title: Update user roles
    params:
      - name: user_id
        required: true
        schema:
          type: string
      - name: roles
        required: true
        schema:
          type: object
          additionalProperties: { type: boolean }

  set-username:
    title: Change user name
    params:
      - name: user_id
        required: true
        schema: { type: string }
      - name: new_username
        required: true
        schema: { type: string }

  get-sessions:
    title: Get user sessions list
    params:
      - name: user_id
        required: true
        schema: { type: string }

  signout-session:
    title: Sign out of user session
    params:
      - name: user_id
        required: true
        schema: { type: string }
      - name: session_id
        required: true
        schema: { type: string }

  signout-all-sessions:
    title: Sign out of all user sessions
    params:
      - name: user_id
        required: true
        schema:
          type: string
