title: Electrron updates management
permissions: [admin]

methods:
  read:
    title: Read list of updates
    params:
      - name: options
        schema:
          read:
            fields:
              id: { type: integer, operator: "=", sortable: true }
              search: { type: string, operator: "like" }
            order_by: [["name", "desc"]]
            limit: { max_limit: 100 }

  create:
    title: Create user
    upload: true
    params:
      - name: file
        required: true
        schema:
          type: object
      - name: fields
        required: true
        schema:
          type: object
          properties:
            username: { type: string }
            password: { type: string }
            enabled: { type: boolean }
            permissions:
              type: object
              additionalProperties: { type: boolean }
            email: { type: string }
            telegram_username: { type: string }
          required:
            - username

  delete:
    title: Remove update
    params:
      - name: updateId
        required: true
        schema:
          type: integer

  setPublished:
    title: Set update enabled
    params:
      - name: updateId
        required: true
        schema:
          type: integer
      - name: published
        required: true
        schema:
          type: boolean

  check:
    title: Check for updates
    permissions: ["*"]
    params:
      - name: options
        required: true
        schema:
          type: object
          properties:
            platform:
              type: string
              enum:
                - win32
                - linux
                - darwin
            arch:
              type: string
              enum:
                - x64
                - x32
            version: { type: string }
          required:
            - platform
            - arch
            - version
          additionalProperties: false
