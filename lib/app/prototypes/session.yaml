title: Session
roles: ["*"]

methods:
  check-authorization:
    title: Check authorization

  signin:
    title: Signin
    params:
      - name: credentials
        required: true
        schema:
          anyOf:
            - type: object
              properties:
                email: { type: string, format: email }
                password: { type: string }
              required: [email, password]
              additionalProperties: false
            - type: object
              properties:
                email: { type: string, format: email }
                firebaseUserAccessToken: { type: string }
              required: [email, firebaseUserAccessToken]
              additionalProperties: false

  authorize:
    title: Authorize session
    roles: [user]
    params:
      - name: password
        required: true
        schema: { type: string }

  signout:
    title: Signout
    roles: [user]

  signup:
    title: Signup
    roles: [guest]
    params:
      - name: fields
        required: true
        schema:
          type: object
          properties:
            email: { type: string, format: email }
            password: { type: string }
            locale: { type: string }
            telegram_username: { type: string }
          required: [email]

  send-confirmation-email:
    title: Send confirmation email

  confirm-email-by-token:
    title: Confirm user email using email confirmation token
    params:
      - name: token
        description: Email confirmation token.
        required: true
        schema:
          type: string

  send-password-recovery-email:
    title: Send password recovery email
    params:
      - name: email
        required: true
        schema: { type: string, format: email }

  set-password-by-token:
    title: Set user password using password recovery token
    params:
      - name: token
        required: true
        schema:
          type: string
      - name: password
        required: true
        schema:
          type: string

  register-push-notifications-token:
    title: Register push notifications token
    params:
      - name: token
        required: true
        schema: { type: string }
