title: Session
roles: ["*"]

methods:
  check-authentication:
    title: Check authentcation

  signin:
    title: Signin
    description: |-
      If `credentials` parameter is specified - will try to sign in user using username and password, otherwise will try to sign in user, using currently used api token.

      **Returns**:

      -   `200`: Sign in successfully.

      -   `401`: Bad credentials.

      -   `403`: Not authorized.

      -   Any other status means bad request, internal or connection error. Refer to the response `statusText` property for more information.
    params:
      - name: credentials
        required: true
        schema:
          type: object
          properties:
            username: { type: string }
            password: { type: string }
          required: [username, password]
          additionalProperties: false
      - name: signin_roles
        description: "<null\\> | <Array\\> Array of roles. Only user, who has this roles can sign in. If `null` roles will not check."
        schema:
          anyOf:
            - { type: "null" }
            - { type: array, items: { type: string } }

  signout:
    title: Signout
    roles: [user]

  signup:
    title: Signup
    roles: [guest]
    params:
      - name: fields
        required: true
        schema:
          type: object
          properties:
            username: { type: string }
            password: { type: string }
            email: { type: string }
            telegram_username: { type: string }
          required:
            - username

  send-confirmation-email:
    title: Send confirmation email
    params:
      - name: user_id
        description: User name or email.
        required: true
        schema:
          type: string

  confirm-email-by-token:
    title: Confirm user email using email confirmation token
    roles: ["*"]
    params:
      - name: token
        description: Email confirmation token.
        required: true
        schema:
          type: string

  send-password-reset-email:
    title: Send password reset email
    params:
      - name: user_id
        description: User name or email.
        required: true
        schema:
          type: string

  set-password-by-token:
    title: Set user password using password recovery token
    params:
      - name: token
        required: true
        schema:
          type: string
      - name: password
        required: true
        schema:
          type: string
