- $id: config
  type: object
  properties:
    # root user
    root:
      type: object
      properties:
        email: { type: string, format: email }
        password: { type: ["null", string] }

      additionalProperties: false
      required: [email, password]

    # frontend
    frontendUrl: { type: string, format: uri }
    frontend:
      type: object
      properties:
        maxParallelCallsPerClient:
          anyOf:
            - type: "null"
            - { type: integer, minimum: 1 }
        maxApiRequestLength: { type: integer, minimum: 1 }
        maxUploadFileSize: { type: integer, minimum: 1 }
        idleTimeout: { type: integer, minimum: 0 }
        sendPingsAutomatically: { type: boolean }
        compress:
          anyOf:
            - type: "null" # use server default
            - type: boolean
            - { type: integer, minimum: 0 }

      additionalProperties: false
      required: [maxParallelCallsPerClient, maxApiRequestLength, maxUploadFileSize, idleTimeout, sendPingsAutomatically, compress]

    # users
    passwordsStrength: { enum: [weak, normal, strong] }
    signupEnabled: { typs: boolean }
    newUserEnabledByDefault: { typs: boolean } # new users are enabled by default

    # tokens
    apiTokensCacheMaxSize: { type: integer, minimum: 1 }

    # sessions
    sessionsCacheMaxSize: { type: integer, minimum: 1 }
    sessionTokenLength: { type: integer, minimum: 6 }
    sessionMaxAge: { type: string, format: duration } # ms
    authorizedSessionMaxAge: { type: string, format: duration } # ms

    # oauth
    oauth:
      type: object
      properties:
        google:
          anyOf:
            - type: "null"
            - type: object
              properties:
                clientId: { type: ["null", string] }
                clientSecret: { type: ["null", string] }
              additionalProperties: false
              required: [clientId, clientSecret]

        facebook:
          anyOf:
            - type: "null"
            - type: object
              properties:
                clientId: { type: ["null", string] }
                clientSecret: { type: ["null", string] }
              additionalProperties: false
              required: [clientId, clientSecret]

        github:
          anyOf:
            - type: "null"
            - type: object
              properties:
                clientId: { type: ["null", string] }
                clientSecret: { type: ["null", string] }
              required: [clientId, clientSecret]
              additionalProperties: false

      additionalProperties: false
      required: [google, facebook, github]

  additionalProperties: false
  required:
    - root

    - frontendUrl
    - frontend

    - passwordsStrength
    - signupEnabled
    - newUserEnabledByDefault

    - apiTokensCacheMaxSize

    - sessionsCacheMaxSize
    - sessionTokenLength
    - sessionMaxAge
    - authorizedSessionMaxAge

    - oauth
