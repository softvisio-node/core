type: object
properties:
  root:
    type: object
    properties:
      email: { type: string, format: email }
      password: { type: ["null", string] }
      telegramUsername:
        anyOf:
          - { type: "null" }
          - { type: string, format: telegram-username }
    required: [email, password, telegramUsername]
    additionalProperties: false

  connections:
    type: object
    properties:
      maxPayloadLength: { type: integer, minimum: 1 } # 64K
      idleTimeout: { type: integer, minimum: 0 }
      sendPingsAutomatically: { type: boolean }
      compress:
        anyOf:
          - { type: boolean }
          - { type: integer }
      required: [maxPayloadLength, idleTimeout, sendPingsAutomatically, compress]
      additionalProperties: false

  locales: { type: array, items: { type: string }, minItems: 1, uniqueItems: true }
  defaultLocale: { type: string }
  currency: { type: string }

  frontendUrl: { type: string, format: uri }
  passwordsStrength: { enum: [weak, normal, strong] }
  signupEnabled: { typs: boolean }
  newUserEnabled: { typs: boolean }
  defaultGravatarImage:
    anyOf:
      - { enum: ["404", mp, identicon, monsterid, wavatar, retro, robohash, blank] }
      - { type: string, format: email }
      - { type: string, format: uri }
  defaultGravatarEncoded: { typs: string }

  authcachemaxsize: { type: integer, minimum: 0 }
  authCacheLastActivityDropInterval: { type: integer, minimum: 10_000 } # ms
  sessionMaxAge: { type: integer, minimum: 60_000 } # ms
  authorizedSessionMaxAge: { type: integer, minimum: 60_000 } # ms
  actionTokenMaxAge: { type: integer, minimum: 60_000 } # ms
  aclCacheMaxSize: { type: integer, minimum: 0 }
  apiCallLogCacheDropInterval: { type: integer, minimum: 10_000 } # ms

  oauth:
    type: object
    properties:
      google:
        type: object
        properies:
          clientId: { type: ["null", string] }
          clientSecret: { type: ["null", string] }
        required: [clientId, clientSecret]
        additionalProperties: false
      facebook:
        type: object
        properies:
          clientId: { type: ["null", string] }
          clientSecret: { type: ["null", string] }
        required: [clientId, clientSecret]
        additionalProperties: false
      github:
        type: object
        properies:
          clientId: { type: ["null", string] }
          clientSecret: { type: ["null", string] }
        required: [clientId, clientSecret]
        additionalProperties: false
    required: [gooele, facebook, github]
    additionalProperties: false

  roles:
    anyOf:
      - { type: "null" }
      - type: object
        additionalProperties:
          type: object
          properties:
            name: { type: string }
            description: { type: string }
            default: { type: boolean }
          required: [name, description, default]
          additionalProperties: false

additionalProperties: false
required:
  - root
  - connections

  - locales
  - defaultLocale
  - currency

  - frontendUrl
  - passwordsStrength
  - signupEnabled
  - newUserEnabled
  - defaultGravatarImage
  - defaultGravatarEncoded

  - authcachemaxsize
  - authCacheLastActivityDropInterval
  - sessionMaxAge
  - authorizedSessionMaxAge
  - actionTokenMaxAge
  - aclCacheMaxSize
  - apiCallLogCacheDropInterval

  - oauth

  - roles

  - acl
