server {
<% if ( listenSocket ) { -%>
    listen                  "unix:<%- server.socketPath %>"<%- server.ssl ? " ssl" : "" %><%- server.proxyProtocol ? " proxy_protocol" : "" %>;
<% } else { -%>
<% if ( !listenIpFamily || listenIpFamily === 4 ) { -%>
    listen                  *:<%- server.port %><%- server.ssl ? " ssl" : "" %><%- server.isUdp ? " udp" : "" %><%- server.proxyProtocol ? " proxy_protocol" : "" %>;
<% } -%>
<% if ( !listenIpFamily || listenIpFamily === 6 ) { -%>
    listen                  [::]:<%- server.port %><%- server.ssl ? " ssl" : "" %><%- server.isUdp ? " udp" : "" %><%- server.proxyProtocol ? " proxy_protocol" : "" %>;
<% } -%>
<% } -%>
<% if ( server.ssl ) { -%>

    ssl_certificate         "<%- server.ssl.certificate %>";
    ssl_certificate_key     "<%- server.ssl.certificateKey %>";
<% } -%>

    proxy_pass              "<%- server.proxy.id %>";

    proxy_protocol          <%- server.proxy.upstreamProxyProtocol ? "on" : "off" %>;
}
