type: object
properties:
  module: { type: string, format: kebab-case }

  type:
    anyOf:
      - { type: string, enum: [pgsql, sqlite] }
      - { type: array, items: { type: string, enum: [pgsql, sqlite] }, minItems: 1, uniqueItems: true }

  patch:
    anyOf:
      - type: "null"
      - { type: integer, minimal: 0 }

  emits:
    anyOf:
      - type: "null"
      - { type: array, items: { type: string, format: kebab-case-relative-file-path }, uniqueItems: true }

  locks:
    anyOf:
      - type: "null"
      - { type: array, items: { type: string, format: kebab-case-relative-file-path }, uniqueItems: true }

  cron:
    anyOf:
      - type: "null"
      - type: object
        additionalProperties:
          type: object
          properties:
            cron: { type: string }
            timezone: { type: string }
            query:
              anyOf:
                - type: string
                - { type: array, items: { type: string }, minIntems: 1 }
            runMissed: { type: boolean, default: true }
            runAsSuperuser: { type: boolean, default: false }

          additionalProperties: false
          required: [cron, query]

additionalProperties: false
required: [module, type, patch]
