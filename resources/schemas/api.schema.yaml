# index
- $id: index
  type: object
  properties:
    emits:
      type: array
      items:
        anyOf:
          - { const: "*" }
          - { type: string, format: event-name }
  additionalProperties: false

# module
- $id: module
  type: object
  properties:
    title: { $ref: "components#/titleString" }
    description: { $ref: "components#/desc" }
    extends: { type: string }
    roles: { $ref: "components#/roles" }
    emits: { type: array, items: { type: string, format: event-name } }
    object-id-resolvers: { type: object, additionalProperties: { type: string } }

    methods:
      type: object
      additionalProperties:
        type: object
        properties:
          title: { $ref: "components#/titleString" }
          description: { $ref: "components#/desc" }
          deprecated: { type: boolean }
          private: { type: boolean }
          roles: { $ref: "components#/roles" }
          persistentConnectionRequired: { type: "boolean" }
          validateParams: { type: "boolean" }
          logApiCalls: { type: boolean }
          activeRequestsLimit: { type: integer, minimum: 0 }
          activeRequestsUserLimit: { type: integer, minimum: 0 }
          params:
            params:
            type: array
            minItems: 1
            items:
              type: object
              properties:
                name: { type: string }
                description: { $ref: "components#/desc" }
                required: { type: boolean }
                schema: { type: object }
              required: [name, schema]
              additionalProperties: false
        required: [title]
        additionalProperties: false

  required: [title]
  additionalProperties: false

# shared components
- $id: components
  titleString:
    type: string

  desc:
    type: string

  roles:
    type: array
    items:
      type: string
      pattern: "^(?:[*]|[a-z-]+)$"
    minItems: 1
